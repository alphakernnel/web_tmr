<!DOCTYPE html>
<html lang="es">
<head>
  <!-- ... (resto del código) ... -->
</head>
<body>
  <!-- ... (resto del código) ... -->
  <button id="chat-button" style="position: fixed; bottom: 150px; right: 20px; background-color: #f44336; color: #fff; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer;">Chat en vivo</button>
  <div id="chat-popup" style="display: none; position: fixed; bottom: 0; right: 0; background-color: #fff; padding: 20px; border: 1px solid #ddd; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2); width: 300px; height: 400px; overflow-y: auto;">
    <h2>Chat en vivo</h2>
    <div id="chat-messages"></div>
    <input id="chat-nickname" type="text" placeholder="Ingresa tu seudónimo...">
    <input id="chat-input" type="text" placeholder="Escribe un mensaje...">
    <button id="chat-send">Enviar</button>
  </div>
  <!-- ... (resto, del código) ... -->
  <script>
    // ... (resto del código) ...
    const chatButton = document.getElementById('chat-button');
    const chatPopup = document.getElementById('chat-popup');
    const chatMessages = document.getElementById('chat-messages');
    const chatInput = document.getElementById('chat-input');
    const chatSend = document.getElementById('chat-send');
    const chatNickname = document.getElementById('chat-nickname');

    let nickname = '';

    // Abrir popup
    chatButton.addEventListener('click', () => {
      chatPopup.style.display = 'block';
    });

    // Cerrar popup
    document.addEventListener('click', (e) => {
      if (e.target === chatPopup || e.target === chatButton) {
        // No hacer nada
      } else {
        chatPopup.style.display = 'none';
      }
    });

    // Enviar mensaje
    chatSend.addEventListener('click', () => {
      const message = chatInput.value.trim();
      if (message !== '') {
        const nicknameValue = chatNickname.value.trim();
        if (nicknameValue !== '') {
          nickname = nicknameValue;
          const messageHTML = `<p><strong>${nickname}:</strong> ${message}</p>`;
          chatMessages.innerHTML += messageHTML;
          chatInput.value = '';
        } else {
          alert('Por favor, ingresa tu seudónimo');
        }
      }
    });
  </script>
</body>
</